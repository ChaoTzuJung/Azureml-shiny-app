Tai=read.csv("/Volumes/Chi-Yun Wu/work/2017/Tai2016_mac.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8", header=T)
Tai=Tai[c(1:721),]
Tai2=Tai
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8", header=T)
View(Tai)
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8", header=F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=Tai[c(1:721),]
Tai=read.csv("/Users/nick/desktop/data.xlsx", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", sep = ',', header=T)
Tai=read.csv("/Users/nick/desktop/data.txt", fileEncoding="UTF-8", sep = ',', header=T)
Tai=Tai[c(1:721),]
Tai=read.csv("/Users/nick/desktop/data.txt", fileEncoding="UTF-8", sep = ',', header=T)
Tai=Tai[c(1:92),]
Tai=read.csv("/Users/nick/desktop/data.txt", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.txt", fileEncoding="UTF-8", header=T)
Tai=Tai[c(1:92),]
Tai2=Tai
Tai2=apply(Tai2,c(1,2), ff)
Tai2=apply(Tai2,c(1,2), ff)
Tai=read.csv("/Users/nick/desktop/data.txt", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=Tai[c(1:92),]
Tai2=Tai
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
tai
Tai
Tai=read.csv("/Users/nick/desktop/data.txt", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/hh.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/hh.csv", fileEncoding="UTF-8-BOM", header=T)
Tai=read.csv("/Users/nick/desktop/hh.csv", fileEncoding="UTF-8-BOM", header=T)
Tai=read.csv("/Users/nick/desktop/hh.csv", fileEncoding="UTF-8-BOM", header=T)
Tai=read.csv("/Users/nick/desktop/hh.csv", header=T)
Tai
Tai=read.csv("/Users/nick/desktop/hh.csv", fileEncoding="UTF-8-BOM", header=T)
Tai=read.csv("/Users/nick/desktop/hh.csv", header=T)
Tai
Tai=Tai[c(1:721),]
Tai2=Tai
Tai2=apply(Tai2,c(1,2), ff)
ff=function(mm){
if(mm=="???????????????(Completely disagree)"){
mm=1
}else{mm=mm}
if(mm=="?????????(Disagree)"){
mm=2
}else{mm=mm}
if(mm=="??????(Acceptable)"){
mm=3
}else{mm=mm}
if(mm=="??????(Agree)"){
mm=4
}else{mm=mm}
if(mm=="????????????(Totally agree)"){
mm=5
}else{mm=mm}
}
mean33=apply(Tai2[,c(1:33)],2,meanvalue)
sd33=apply(Tai2[,c(1:33)],2,sdvalue)
rank33=rank(-mean33)
mm=matrix(c(round(mean33,2),round(sd33,2),round(rank33,0) ),byrow = F,ncol=3)
mm=cbind(round(mean33,2),round(sd33,2),round(rank33,0) )
meanvalue=function(ll){
return(mean(as.numeric(ll)))
}
sdvalue=function(ll){
return(sd(as.numeric(ll)))
}
countresult=t(apply(Tai2[,c(21:29)],2,count))
count=function(ll){
return(rev(round(table(ll)/721*100,1)))}
manyi=countresult[,1]+countresult[,2]
rankmanyi=rank(-manyi)
manyimm=cbind(manyi,rankmanyi)
unmanyi=countresult[,4]+countresult[,5]
rankunmanyi=rank(-unmanyi)
unmanyimm=cbind(unmanyi,rankunmanyi)
mean721=apply(Tai2[,c(21:29)],1,meanvalue)
mean(mean721)
sd(mean721)
ttbind=NULL
for(ii in c(34:40)){
tt=table(Tai2[,ii])
tn=names(tt)
ttt=cbind(tn,tt,rep(ii,length(tt)))
ttbind=rbind(ttbind,ttt)
}
Tai3=cbind(round(apply(Tai2[,c(1:15)],1,meanvalue),2),round(apply(Tai2[,c(16:20)],1,meanvalue),2),round(apply(Tai2[,c(21:29)],1,meanvalue),2),Tai2[,c(30:33)])
colnames(Tai3)[1:3]=c("Type1","Type2","Type3")
allmm=NULL
ii=37
ttsub=ttbind[which(ttbind[,3]==ii),]
s1=Tai3[which(Tai2[,ii]==ttsub[2,1]),]
Tai=read.csv("/Users/nick/desktop/hh.csv", fileEncoding="UTF-8", header=T)
View(s1)
View(s1)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
source('~/Downloads/statistic.R')
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8",)
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8")
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8")
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8-DOM")
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8")
Tai=read.csv("/Users/nick/desktop/data/data.csv", fileEncoding="UTF-8")
Tai=read.csv("/Users/nick/desktop/test.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/test.csv")
Tai=Tai[c(1:721),]
Tai=read.csv("/Users/nick/desktop/test.csv")
Tai=read.csv("/Users/nick/desktop/test.csv")
View(Tai)
Tai=read.csv("/Users/nick/desktop/test.csv", header = False)
Tai=read.csv("/Users/nick/desktop/test.csv", header = false)
Tai=read.csv("/Users/nick/desktop/test.csv", header = f)
Tai=read.csv("/Users/nick/desktop/test.csv", header = F)
Tai=read.csv("/Users/nick/desktop/test.csv", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding = "UTF-8", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding = "UTF-8-DOM", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding = "BIG-5", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding = "BIG5", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding = "UTF-8", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", encoding = "UTF-8", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding = "UTF-8", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding = "UTF-8", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF-8", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="UTF8", header = F)
Tai=read.csv("/Users/nick/desktop/data.csv", fileEncoding="utf8", header = F)
Tai=read.csv("/Users/nick/desktop/test.csv", header = F)
View(Tai)
View(Tai)
Tai=read.csv("/Users/nick/desktop/test.csv", fileEncoding = "UTF-8", header = F)
Tai=read.csv("/Users/nick/desktop/test.csv", encoding = "UTF-8", header = F)
View(Tai)
View(Tai)
View(Tai)
readLines(file("/Users/nick/desktop/test.csv", encoding="UTF-8"), warn=FALSE)
readLines(file("/Users/nick/desktop/test.csv", fileEncoding="UTF-8"), warn=FALSE)
readLines(file("/Users/nick/desktop/test.csv", Encoding="UTF-8"), warn=FALSE)
readLines(file("/Users/nick/desktop/test.csv", encoding="UTF-8"), warn=FALSE)
readLines(file("/Users/nick/desktop/Shiu_2.csv", encoding="UTF-8"), warn=FALSE)
data <- readLines("/Users/nick/desktop/test.csv", encoding="big5")
View(Tai)
data <- readLines("/Users/nick/desktop/test.csv", encoding="big5")
data <- readLines("/Users/nick/desktop/test.csv", encoding="UTF-8")
data <- readLines("/Users/nick/desktop/test.csv", encoding="UTF-8-DOM")
data = readLines("/Users/nick/desktop/test.csv", encoding="UTF-8-DOM")
readLines(file("/Users/nick/desktop/Shiu.csv", encoding="UTF-8"), warn=FALSE)
Tai=read.csv("/Users/nick/desktop/shiu.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/desktop/shiu.csv", header=T)
View(Tai)
Tai=read.csv("/Users/nick/desktop/shiu.csv", encoding = "UTF-8", header=T)
Sys.setlocale(category="LC_ALL", locale = "English_United States.1252")
read.table("test.csv", sep = "," , header=TRUE, fileEncoding = "UTF-8")
Tai=read.table("/Users/nick/desktop/shiu.csv", fileEncoding="UTF-8", header=T)
Tai=read.table("/User/Nick/Desktop/test.csv", fileEncoding="UTF-8", header=T)
Tai=read.table("/Users/nick/Desktop/test.csv", fileEncoding="UTF-8", header=T)
Tai=read.table("/Users/nick/Desktop/test.csv", header=T)
Tai=read.table("/Users/nick/Desktop/test.csv", header=T)
Tai=read.table("/Users/nick/Desktop/test.csv", sep = ",", header=T)
View(Tai)
View(Tai)
Tai=read.table("/Users/nick/Desktop/test.csv", sep = ",", header=T, fileEncoding = "UTF-8")
Tai=read.table("/Users/nick/Desktop/test.csv", sep = ",", header=T, fileEncoding = "utf8")
Tai=read.table("/Users/nick/Desktop/test.csv", sep = ",", header=T, fileEncoding = "utf-8")
Tai=read.table("/Users/nick/Desktop/test.csv", sep = ",", header=T, encoding = "utf-8")
View(Tai)
View(Tai)
Tai=read.table("/Users/nick/Desktop/test.csv", sep = ",", header=T, encoding = "utf-8")
View(Tai)
View(Tai)
Tai=read.table("/Users/nick/Desktop/test.csv", sep = ",", header=T, encoding = "utf-8")
etlocale("LC_ALL", "English_United States.932")
setlocale("LC_ALL", "English_United States.932")
View(Tai)
View(Tai)
Tai=read.csv("/Users/nick/Desktop/data.csv", fileEncoding="UTF-8", header=T)
View(Tai)
View(Tai)
View(Tai)
Tai=read.csv("/Users/nick/Desktop/data/data.csv", fileEncoding="UTF-8", header=T)
Tai=read.csv("/Users/nick/Desktop/test.csv", fileEncoding="UTF-8", header=T)
View(Tai)
View(Tai)
Tai=read.csv("/Users/nick/Desktop/test.csv", fileEncoding="UTF-8", header=F)
View(Tai)
Tai=read.csv("/Users/nick/Desktop/test.csv", fileEncoding="UTF-8", header=F)
View(Tai)
Tai=read.csv("/Users/nick/Desktop/test.csv", encoding="UTF-8", header=F)
View(Tai)
View(Tai)
Tai=read.csv("/Users/nick/Desktop/test.csv", encoding="UTF-8", header=F)
tail
tai
Tai
ls
Tai=read.csv("/Users/nick/Desktop/test.csv", fileEncoding="UTF-8", header=F)
Tai=read.csv("/Users/nick/Desktop/test.csv", fileEncoding="UTF-8")
t = read.csv("test.csv",fileEncoding="UTF-8")
t = read.csv("/Users/nick/Desktop/test.csv",fileEncoding="UTF-8")
View(Tai)
View(t)
Tai=read.csv("/Users/nick/Desktop/data.csv", fileEncoding="UTF-8")
meanvalue=function(ll){
return(mean(as.numeric(ll)))
}
sdvalue=function(ll){
return(sd(as.numeric(ll)))
}
count=function(ll){
vv= rep(0.0,5)
aa =round(table(ll)/90*100,1)
if(length(aa) < 5){
rr=which(c("1","2","3","4","5")%in%names(aa))
#print(vv)
#print(rr)
vv[rr] = aa[which(names(aa) == rr)]
return(rev(vv))
}
return(rev(aa))
}
ff = function(mm){
if(mm == "非常不滿意(Completely disagree)"){
mm=1
}else{mm=mm}
if(mm=="不滿意(Disagree)"){
mm=2
}else{mm=mm}
if(mm=="尚可(Acceptable)"){
mm=3
}else{mm=mm}
if(mm=="滿意(Agree)"){
mm=4
}else{mm=mm}
if(mm=="非常滿意(Totally agree)"){
mm=5
}else{mm=mm}
}
Tai=Tai[c(1:90),]
Tai2=Tai
Tai2=apply(Tai2,c(1,2), ff)
mean33=apply(Tai2[,c(1:33)],2,meanvalue)
sd33=apply(Tai2[,c(1:33)],2,sdvalue)
rank33=rank(-mean33)
mm=matrix(c(round(mean33,2),round(sd33,2),round(rank33,0) ),byrow = F,ncol=3)
mm=cbind(round(mean33,2),round(sd33,2),round(rank33,0) )
countresult=t(apply(Tai2[,c(21:29)],2,count))
manyi=as.numeric(unlist(countresult[,1]))+as.numeric(unlist(countresult[,2]))
rankmanyi=rank(-manyi)
manyimm=cbind(manyi,rankmanyi)
unmanyi=as.numeric(countresult[,4]+countresult[,5])
rankunmanyi=rank(-unmanyi)
unmanyimm=cbind(unmanyi,rankunmanyi)
mean721=apply(Tai2[,c(21:29)],1,meanvalue)
mean(mean721)
sd(mean721)
ttbind=NULL
for(ii in c(34:39)){
tt=table(Tai2[,ii])
tn=names(tt)
ttt=cbind(tn,tt,rep(ii,length(tt)))
ttbind=rbind(ttbind,ttt)
}
Tai3=cbind(round(apply(Tai2[,c(1:15)],1,meanvalue),2),round(apply(Tai2[,c(16:20)],1,meanvalue),2),round(apply(Tai2[,c(21:29)],1,meanvalue),2),Tai2[,c(30:33)])
colnames(Tai3)[1:3]=c("Type1","Type2","Type3")
allmm=NULL
ii=37
ttsub=ttbind[which(ttbind[,3]==ii),]
s1=Tai3[which(Tai2[,ii]==ttsub[2,1]),]
s2=Tai3[which(Tai2[,ii]==ttsub[3,1]),]
s3=Tai3[which(Tai2[,ii]==ttsub[1,1]),]
for(jj in 1:dim(Tai3)[2]){
#ttest=t.test(as.numeric(s1[,jj]),as.numeric(s2[,jj]))
anova=aov(c(as.numeric(s1[,jj]),as.numeric(s2[,jj]),as.numeric(s3[,jj]))~c(rep(1,dim(s1)[1]),rep(2,dim(s2)[1]),rep(3,dim(s3)[1])) )
sanova=unlist(summary(anova))
mm=matrix(c(dim(s1)[1],round(mean(as.numeric(s1[,jj])),2), round(sd(as.numeric(s1[,jj])),2), round(sanova["F value1"],2), round(sanova["Pr(>F)1"],4), dim(s2)[1], round(mean(as.numeric(s2[,jj])),2), round(sd(as.numeric(s2[,jj])),2),"-","-",dim(s3)[1], round(mean(as.numeric(s3[,jj])),2), round(sd(as.numeric(s3[,jj])),2),"-","-"), byrow=T, ncol=5)
allmm=rbind(allmm,mm)
print(allmm)
}
#read file
Tai=read.csv("/Users/nick/Desktop/data.csv", fileEncoding="UTF-8")
#no 16 櫥櫃 整體維修->"硬體設施"->"整體管理狀況"
#substitue value
meanvalue=function(ll){
return(mean(as.numeric(ll)))
}
sdvalue=function(ll){
return(sd(as.numeric(ll)))
}
# get percentage of 1~5 in each item
count=function(ll){
vv= rep(0.0,5)
aa =round(table(ll)/90*100,1)
if(length(aa) < 5){
rr=which(c("1","2","3","4","5")%in%names(aa))
#print(vv)
#print(rr)
vv[rr] = aa[which(names(aa) == rr)]
return(rev(vv))
}
return(rev(aa))
}
ff = function(mm){
if(mm == "非常不滿意(Completely disagree)"){
mm=1
}else{mm=mm}
if(mm=="不滿意(Disagree)"){
mm=2
}else{mm=mm}
if(mm=="尚可(Acceptable)"){
mm=3
}else{mm=mm}
if(mm=="滿意(Agree)"){
mm=4
}else{mm=mm}
if(mm=="非常滿意(Totally agree)"){
mm=5
}else{mm=mm}
}
Tai=Tai[c(1:90),]
Tai2=Tai
Tai2=apply(Tai2,c(1,2), ff)
#statistics for 33 itmes
mean33=apply(Tai2[,c(1:33)],2,meanvalue)
sd33=apply(Tai2[,c(1:33)],2,sdvalue)
rank33=rank(-mean33)
mm=matrix(c(round(mean33,2),round(sd33,2),round(rank33,0) ),byrow = F,ncol=3)
mm=cbind(round(mean33,2),round(sd33,2),round(rank33,0) )
countresult=t(apply(Tai2[,c(21:29)],2,count))
#5+4 滿意
manyi=as.numeric(unlist(countresult[,1]))+as.numeric(unlist(countresult[,2]))
rankmanyi=rank(-manyi)
manyimm=cbind(manyi,rankmanyi)
#1+2 不滿意
unmanyi=as.numeric(countresult[,4]+countresult[,5])
rankunmanyi=rank(-unmanyi)
unmanyimm=cbind(unmanyi,rankunmanyi)
#get mean and sd value in 3 group (each group contains many items)
mean721=apply(Tai2[,c(21:29)],1,meanvalue)
mean(mean721)
sd(mean721)
# table for count of each identity
ttbind=NULL
for(ii in c(34:39)){
tt=table(Tai2[,ii])
tn=names(tt)
ttt=cbind(tn,tt,rep(ii,length(tt)))
ttbind=rbind(ttbind,ttt)
}
#value in three big groups and four comprehensive last four items
Tai3=cbind(round(apply(Tai2[,c(1:15)],1,meanvalue),2),round(apply(Tai2[,c(16:20)],1,meanvalue),2),round(apply(Tai2[,c(21:29)],1,meanvalue),2),Tai2[,c(30:33)])
colnames(Tai3)[1:3]=c("Type1","Type2","Type3")
# table for test
allmm=NULL
#for(ii in 34:40){
#ll=length(which(ttbind[,3]==ii))
ii=37
ttsub=ttbind[which(ttbind[,3]==ii),]
s1=Tai3[which(Tai2[,ii]==ttsub[2,1]),]
s2=Tai3[which(Tai2[,ii]==ttsub[3,1]),]
s3=Tai3[which(Tai2[,ii]==ttsub[1,1]),]
for(jj in 1:dim(Tai3)[2]){
#ttest=t.test(as.numeric(s1[,jj]),as.numeric(s2[,jj]))
anova=aov(c(as.numeric(s1[,jj]),as.numeric(s2[,jj]),as.numeric(s3[,jj]))~c(rep(1,dim(s1)[1]),rep(2,dim(s2)[1]),rep(3,dim(s3)[1])) )
sanova=unlist(summary(anova))
mm=matrix(c(dim(s1)[1],round(mean(as.numeric(s1[,jj])),2), round(sd(as.numeric(s1[,jj])),2), round(sanova["F value1"],2), round(sanova["Pr(>F)1"],4), dim(s2)[1], round(mean(as.numeric(s2[,jj])),2), round(sd(as.numeric(s2[,jj])),2),"-","-",dim(s3)[1], round(mean(as.numeric(s3[,jj])),2), round(sd(as.numeric(s3[,jj])),2),"-","-"), byrow=T, ncol=5)
allmm=rbind(allmm,mm)
print(allmm)
}
#}
View(t)
View(t)
library(shiny)
library(shiny)
#--- All Need Packages
packages.need <- c("shiny","dplyr","data.table","bitops","RCurl","rjson")
#--- Download Packages
packages.download <- !packages.need %in% installed.packages()[,"Package"]
if(any(packages.download))
install.packages(packages.need[packages.download],dependencies=TRUE)
#--- Load packages
lapply(packages.need, require, character.only = TRUE)
library(shiny)
library(shiny)
runExample("01_hello")
runApp('Desktop/Azureml-shiny-app/Shiny_Titanic')
runApp('Desktop/Azureml-shiny-app/Shiny_Titanic')
runApp()
runApp('Desktop/Azureml-shiny-app/Shiny_Titanic')
